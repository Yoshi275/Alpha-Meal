
<!DOCTYPE html>

	<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Real landing page</title>

	<!-- Modernizr JS -->
	<script src="js/modernizr-2.6.2.min.js"></script>
	<!-- FOR IE9 below -->
	<!--[if lt IE 9]>
	<script src="js/respond.min.js"></script>
	<![endif]-->

	</head>


	<!-- 
		INFO:
		Add 'boxed' class to body element to make the layout as boxed style.
		Example: 
		<body class="boxed">	
	-->
	<body>
	<p>A minimalistic *cough cough* landing page</p>
	<ul>
		<em>things to do</em>
		<li><strike>get postcode input</strike></li>
		<li><strike>API Get</strike></li>
		<li>Parse out the result</li>
		<li>configure look</li>
	</ul>
	<!-- jQuery -->
	<script src="js/jquery.min.js"></script>
	<!-- jQuery Easing -->
	<script src="js/jquery.easing.1.3.js"></script>
	<!-- Bootstrap -->
	<script src="js/bootstrap.min.js"></script>
	<!-- Waypoints -->
	<script src="js/jquery.waypoints.min.js"></script>
	<!-- Flexslider -->
	<script src="js/jquery.flexslider-min.js"></script>

		<p>Postcode: <input id="postcode" type="text" name="user" value="Postcode"></p>
				<p>Any preferred shop?		 <input id="term" type="text" name="user" value="Anything!"></p>

				<p>Cuisine: <form action="demo_form.asp" method="get" id="cuisine">
				  <input type="checkbox" name="cuisine" value="hotdog" value="burgers"> Fast food<br>
				  <input type="checkbox" name="cuisine" value="tradamerican" > Western <br>
				  <input type="checkbox" name="cuisine" value="japanese"> Japanese <br>
				  <input type="checkbox" name="cuisine" value="korean" > Korean <br>
				  <input type="checkbox" name="cuisine" value="singaporean"> Singaporean <br>
				  <input type="checkbox" name="cuisine" value="mexican" > Mexican <br>
				  <input type="checkbox" name="cuisine" value="breakfast_brunch" > Brunch <br>
				  <input type="checkbox" name="cuisine" value="desserts" > Desserts <br>
				</form></p>

				<p>How far away?</p>
				<form action="" id="distance">
				  <input type="radio" name="distance" value=1000> 1km<br>
				  <input type="radio" name="distance" value=5000> 5km<br>
				  <input type="radio" name="distance" value=10000> 10km<br>
				  <input type="radio" name="distance" value=40000> Infinity
				</form>
				<button onclick="query()">Search for food!</button>

				<div id="results"></div>

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js"></script>
        <script type="text/javascript" src="js/oauth.js"></script>
        <script type="text/javascript" src="js/sha1.js"></script>
        <script type="text/javascript">
        //global variables
        var info;
        var res_no;
            function query() {
            	var auth = {
                //
                // Update with your auth tokens.
                //
                consumerKey : "BVqw4tz8MZxa0Xf-q9Mehw",
                consumerSecret : "MgCMR8S6q3LVBp_c6SKFYzekGy4",
                accessToken : "28ezyOcLm4xDIjnobx7dn-QMTVS_c-0z",
                // This example is a proof of concept, for how to use the Yelp v2 API with javascript.
                // You wouldn't actually want to expose your access token secret like this in a real application.
                accessTokenSecret : "CY29gXAsiSDqJTFENUolVRihU8M",
                serviceProvider : {
                    signatureMethod : "HMAC-SHA1"
                }
            };


            /* Checklist: term(shop name) id=term;
            location(location) id=postcode;
            category_filter(cuisine), id=cuisine;
            
            */
            var term; //shop name
            if ($("#term").val() == "Anything!") 
            	{term = ""} 
            else {term = $("#term").val()};

            var location; //postcode
            location = $("#postcode").val();
            console.log("location",location);

            var cuisine = "";//category filter
            $.each($("input[name='cuisine']:checked"), function(){            

                cuisine += $(this).val();
                cuisine += ","
				if ($(this).val() == "japanese") {cuisine += "sushi,"};
				if ($(this).val() == "tradamerican") {cuisine += "bbq,british,french,german,"}
				if ($(this).val() == "hotdog") {cuisine += "burgers,"};
            });
            cuisine = cuisine.substring(0,(cuisine.length-1))
            console.log("cuisine:",cuisine);

 			var distance = parseInt($("input[name=distance]:checked").val());

            var accessor = {
                consumerSecret : auth.consumerSecret,
                tokenSecret : auth.accessTokenSecret
            };
            parameters = [];
            parameters.push(['term', term]);
            parameters.push(['location', location]);
            parameters.push(['category_filter', cuisine]);
            parameters.push(['radius_filter', distance]);
            parameters.push(['callback', 'cb']);
            parameters.push(['cc', 'SG']);
            parameters.push(['oauth_consumer_key', auth.consumerKey]);
            parameters.push(['oauth_consumer_secret', auth.consumerSecret]);
            parameters.push(['oauth_token', auth.accessToken]);
            parameters.push(['oauth_signature_method', 'HMAC-SHA1']);

console.log(parameters)

            var message = {
                'action' : 'http://api.yelp.com/v2/search',
                'method' : 'GET',
                'parameters' : parameters
            };

            OAuth.setTimestampAndNonce(message);
            OAuth.SignatureMethod.sign(message, accessor);

            var parameterMap = OAuth.getParameterMap(message.parameters);
            console.log('parameterMap is',parameterMap);

            $.ajax({
                'url' : message.action,
                'data' : parameterMap,
                'dataType' : 'jsonp',
                'jsonpCallback' : 'cb',
                'success' : function(data, textStats, XMLHttpRequest) {
                    console.log('data is', data);
                    info = data;
                    res_no = 0
                    $("#results").append(info.businesses[res_no].name + " " + info.businesses[res_no].location.display_address);
                    var button_dunlike = $('<button onclick="dunlike()">Nope, not this one!</button>');
    				button_dunlike.appendTo($("#results"));
    				var button_like = $('<button onclick="like()">Awesome I love this lets go!</button>');
    				button_like.appendTo($("#results"));
    				console.log('ajax done')
                }
            });
            }//end of query()
			//document.getElementById("results").innerHTML =
			//data.business[0].name + " " + data.business[0].location.display_address;
			function dunlike() {
				console.log("dunlike");
				res_no += 1;
				console.log("current result number",res_no);
				$("#results").empty();
				$("#results").append(info.businesses[res_no].name + " " + info.businesses[res_no].location.display_address);
				var button_dunlike = $('<button onclick="dunlike()">Nope, not this one!</button>');
    			button_dunlike.appendTo($("#results"));
    			var button_like = $('<button onclick="like()">Awesome I love this lets go!</button>');
    			button_like.appendTo($("#results"));
			};//end of dunlike
			function like() {

			};//end of like
        </script>
				


	</body>
</html>
-->
-->
<!--
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js"></script>
        <script type="text/javascript" src="js/oauth.js"></script>
        <script type="text/javascript" src="js/sha1.js"></script>
        <script type="text/javascript">
            function query() {
            	var auth = {
                //
                // Update with your auth tokens.
                //
                consumerKey : "BVqw4tz8MZxa0Xf-q9Mehw",
                consumerSecret : "MgCMR8S6q3LVBp_c6SKFYzekGy4",
                accessToken : "28ezyOcLm4xDIjnobx7dn-QMTVS_c-0z",
                // This example is a proof of concept, for how to use the Yelp v2 API with javascript.
                // You wouldn't actually want to expose your access token secret like this in a real application.
                accessTokenSecret : "CY29gXAsiSDqJTFENUolVRihU8M",
                serviceProvider : {
                    signatureMethod : "HMAC-SHA1"
                }
            };




            var terms = $("#cuisine").val();
            var near = $("#postcode").val();

            var accessor = {
                consumerSecret : auth.consumerSecret,
                tokenSecret : auth.accessTokenSecret
            };
            parameters = [];
            parameters.push(['term', terms]);
            parameters.push(['location', near]);
            parameters.push(['callback', 'cb']);
            parameters.push(['oauth_consumer_key', auth.consumerKey]);
            parameters.push(['oauth_consumer_secret', auth.consumerSecret]);
            parameters.push(['oauth_token', auth.accessToken]);
            parameters.push(['oauth_signature_method', 'HMAC-SHA1']);

console.log(parameters)

            var message = {
                'action' : 'http://api.yelp.com/v2/search',
                'method' : 'GET',
                'parameters' : parameters
            };

            OAuth.setTimestampAndNonce(message);
            OAuth.SignatureMethod.sign(message, accessor);

            var parameterMap = OAuth.getParameterMap(message.parameters);
            console.log(parameterMap);

            $.ajax({
                'url' : message.action,
                'data' : parameterMap,
                'dataType' : 'jsonp',
                'jsonpCallback' : 'cb',
                'success' : function(data, textStats, XMLHttpRequest) {
                    console.log(data);
                    //$("body").append(output);
                }
            });
            }

        </script>
<p>Postcode: <input id="postcode" type="text" name="user" value="Postcode"></p>
<p>Food type: <select id="cuisine">
  <option>Fast food</option>
  <option>Western</option>
  <option>Japanese</option>
  <option>Korean</option>
  <option>Singaporean</option>
</select></p>

<button onclick="query()">Search for food!</button>

	</body>
</html>
